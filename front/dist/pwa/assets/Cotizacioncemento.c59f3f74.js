import{T as d,U as u,V as a,W as i,X as s,aE as c,$ as p,M as b,_ as g,aF as x,aD as h,Y as _,Z as Q,aG as D}from"./index.8e5efdfb.js";import{Q as v,a as m,d as V}from"./format.7d90d4c2.js";import{Q as y}from"./QList.75259ae5.js";import{Q as U}from"./QBtnDropdown.5b46475c.js";import{Q as k}from"./QTd.47060a52.js";import{Q as w}from"./QTable.9ece2fc3.js";import{Q as F}from"./QSpace.1f3d3d67.js";import{Q as r}from"./QSelect.7f7f9668.js";import{Q as E}from"./QForm.4421addc.js";import{Q as S}from"./QPage.8f9149b4.js";import{C}from"./ClosePopup.3be4487d.js";import{h as A}from"./moment.40bc58bf.js";import{E as N}from"./Excel.60733b5e.js";import{_ as G}from"./plugin-vue_export-helper.21dcd24c.js";import"./QBtnGroup.7ea5ef23.js";import"./QMarkupTable.f4b57dd0.js";import"./index.8bd2ab55.js";const M={name:"CotizacionsPage",data(){return{cotizacioncementos:[],cotizacioncemento:{},cotizacionDialog:!1,loading:!1,productosAll:[],products:[],clientes:[],clientesAll:[],zonas:[],marcas:[],actionPeriodo:"",filter:"",columns:[{name:"actions",label:"Acciones",align:"center"},{name:"fecha",label:"Fecha",align:"left",field:"fecha"},{name:"cliente",label:"Cliente",align:"left",field:"cliente"},{name:"marca",label:"Marca",align:"left",field:"marca"},{name:"producto",label:"Producto",align:"left",field:"producto"},{name:"cantidad",label:"Cantidad",align:"left",field:"cantidad"},{name:"medida",label:"medida",align:"left",field:"medida"},{name:"zona",label:"Zona",align:"left",field:"zona"},{name:"precio_compra_cf",label:"Precio Compra CF",align:"left",field:"precio_compra_cf"},{name:"precio_compra_sf",label:"Precio Compra SF",align:"left",field:"precio_compra_sf"},{name:"precio_venta_cf",label:"Precio Venta CF",align:"left",field:"precio_venta_cf"},{name:"precio_venta_sf",label:"Precio Venta SF",align:"left",field:"precio_venta_sf"},{name:"observacion",label:"Observaci\xF3n",align:"left",field:"observacion"}]}},mounted(){this.cotizacionsGet(),this.getProductos(),this.getClientes(),this.getZonas()},methods:{exportExcel(){let t=[{sheet:"cotizacioncementos",columns:[{label:"Fecha",value:"fecha"},{label:"Nombre del cliente",value:"cliente"},{label:"Marca",value:"marca"},{label:"Producto",value:"producto"},{label:"Cantidad",value:"cantidad"},{label:"medida",value:"medida"},{label:"Zona",value:"zona"},{label:"Precio_compra_cf",value:"precio_compra_cf"},{label:"Precio_compra_sf",value:"precio_compra_sf"},{label:"Precio_venta_cf",value:"precio_venta_cf"},{label:"Precio_venta_sf",value:"precio_venta_sf"},{label:"Observacion",value:"observacion"}],content:this.cotizacioncementos}];N.export(t,"Reporte de Cotizaciones")},getZonas(){this.$axios.get("zonas").then(t=>{this.zonas=t.data}).catch(t=>{console.log(t)})},filterClientes(t,e){if(t===""){e(()=>{this.clientes=this.clientesAll});return}const f=t.toLowerCase();e(()=>{this.clientes=this.clientesAll.filter(z=>z.nombre_cliente.toLowerCase().indexOf(f)>-1)})},getClientes(){this.$axios.get("clientes").then(t=>{this.clientes=t.data,this.clientesAll=t.data}).catch(t=>{console.log(t)})},filterProducts(t){console.log(t),t!==null&&(this.products=this.productosAll.filter(e=>(e==null?void 0:e.marca)===t))},getProductos(){this.$axios.get("productocementos").then(t=>{this.productosAll=t.data,this.products=this.productosAll,this.products.forEach(e=>{this.marcas.includes(e.marca)||this.marcas.push(e.marca)})}).catch(t=>{console.log(t)})},cotizacionNew(){this.cotizacioncemento={fecha:A().format("YYYY-MM-DD"),cliente:"",marca:"",producto:"",cantidad:0,medida:"Un",zona:"",precio_compra_cf:0,precio_compra_sf:0,precio_venta_cf:0,precio_venta_sf:0,observacion:""},this.actionPeriodo="Nueva",this.cotizacionDialog=!0},cotizacionsGet(){this.loading=!0,this.$axios.get("cotizacioncementos").then(t=>{this.cotizacioncementos=t.data}).catch(t=>{this.$alert.error(t.response.data.message)}).finally(()=>{this.loading=!1})},cotizacionPost(){this.loading=!0,this.$axios.post("cotizacioncementos",this.cotizacioncemento).then(t=>{this.cotizacionsGet(),this.cotizacionDialog=!1,this.$alert.success("Cotizacion creada")}).catch(t=>{this.$alert.error(t.response.data.message)}).finally(()=>{this.loading=!1})},cotizacionPut(){this.loading=!0,this.$axios.put("cotizacioncementos/"+this.cotizacioncemento.id,this.cotizacioncemento).then(t=>{this.cotizacionsGet(),this.cotizacionDialog=!1,this.$alert.success("Cotizacion actualizada")}).catch(t=>{this.$alert.error(t.response.data.message)}).finally(()=>{this.loading=!1})},cotizacionEdit(t){this.cotizacioncemento={...t},this.actionPeriodo="Editar",this.cotizacionDialog=!0},cotizacionDelete(t){this.$alert.dialog("\xBFDesea eliminar la cotizacion?").onOk(()=>{this.loading=!0,this.$axios.delete("cotizacioncementos/"+t).then(e=>{this.cotizacionsGet(),this.$alert.success("Cotizacion eliminada")}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1})})}}},B={class:"text-right"};function O(t,e,f,z,o,n){return d(),u(S,{class:"q-pa-md"},{default:a(()=>[i(w,{rows:o.cotizacioncementos,columns:o.columns,dense:"","wrap-cells":"",flat:"",bordered:"","rows-per-page-options":[0],title:"cotizacioncementos",filter:o.filter},{"top-right":a(()=>[i(s,{icon:"download",color:"green",label:"Exportar",onClick:n.exportExcel,"no-caps":""},null,8,["onClick"]),i(s,{color:"primary",label:"Nuevo",onClick:n.cotizacionNew,outline:"","no-caps":"",icon:"add_circle_outline",loading:o.loading},null,8,["onClick","loading"]),i(c,{modelValue:o.filter,"onUpdate:modelValue":e[0]||(e[0]=l=>o.filter=l),label:"Buscar",dense:"",outlined:""},{append:a(()=>[i(p,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-actions":a(l=>[i(k,{props:l},{default:a(()=>[i(U,{label:"Opciones","no-caps":"",size:"10px",dense:"",color:"primary"},{default:a(()=>[i(y,null,{default:a(()=>[b((d(),u(v,{clickable:"",onClick:P=>n.cotizacionEdit(l.row)},{default:a(()=>[i(m,{avatar:""},{default:a(()=>[i(p,{name:"edit"})]),_:1}),i(m,null,{default:a(()=>[i(V,null,{default:a(()=>[g("Editar")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[C]]),b((d(),u(v,{clickable:"",onClick:P=>n.cotizacionDelete(l.row.id)},{default:a(()=>[i(m,{avatar:""},{default:a(()=>[i(p,{name:"delete"})]),_:1}),i(m,null,{default:a(()=>[i(V,null,{default:a(()=>[g("Eliminar")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[C]])]),_:2},1024)]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","columns","filter"]),i(D,{modelValue:o.cotizacionDialog,"onUpdate:modelValue":e[16]||(e[16]=l=>o.cotizacionDialog=l),persistent:""},{default:a(()=>[i(x,{style:{"min-width":"350px","max-width":"800px"}},{default:a(()=>[i(h,{class:"q-pb-none row items-center"},{default:a(()=>[_("div",null,Q(o.actionPeriodo)+" Cotizacion ",1),i(F),i(s,{icon:"close",flat:"",round:"",dense:"",onClick:e[1]||(e[1]=l=>o.cotizacionDialog=!1)})]),_:1}),i(h,{class:"q-pt-none"},{default:a(()=>[i(E,{onSubmit:e[15]||(e[15]=l=>o.cotizacioncemento.id?n.cotizacionPut():n.cotizacionPost())},{default:a(()=>[i(c,{modelValue:o.cotizacioncemento.fecha,"onUpdate:modelValue":e[2]||(e[2]=l=>o.cotizacioncemento.fecha=l),label:"Fecha",dense:"",outlined:"",type:"date",disable:!0},null,8,["modelValue"]),i(r,{modelValue:o.cotizacioncemento.cliente,"onUpdate:modelValue":e[3]||(e[3]=l=>o.cotizacioncemento.cliente=l),onFilter:n.filterClientes,rules:[l=>!!l||"Seleccione un cliente"],filled:"","emit-value":"","map-options":"",standout:"","use-input":"",label:"Cliente",options:o.clientes,"option-value":"id","option-label":"nombre_cliente",dense:"",clearable:""},null,8,["modelValue","onFilter","rules","options"]),i(r,{modelValue:o.cotizacioncemento.marca,"onUpdate:modelValue":[e[4]||(e[4]=l=>o.cotizacioncemento.marca=l),n.filterProducts],label:"Marca",dense:"",outlined:"","use-input":"",options:o.marcas},null,8,["modelValue","onUpdate:modelValue","options"]),i(r,{modelValue:o.cotizacioncemento.producto,"onUpdate:modelValue":e[5]||(e[5]=l=>o.cotizacioncemento.producto=l),label:"Producto",dense:"",outlined:"","use-input":"","option-label":"nombre","option-value":"nombre","emit-value":"","map-options":"",options:o.products},null,8,["modelValue","options"]),i(c,{modelValue:o.cotizacioncemento.cantidad,"onUpdate:modelValue":e[6]||(e[6]=l=>o.cotizacioncemento.cantidad=l),label:"Cantidad",type:"number",dense:"",outlined:"",rules:[l=>!!l||"Campo requerido"]},null,8,["modelValue","rules"]),i(r,{modelValue:o.cotizacioncemento.medida,"onUpdate:modelValue":e[7]||(e[7]=l=>o.cotizacioncemento.medida=l),filled:"",standout:"",label:"Medida",dense:"",outlined:"",options:[{label:"Un",value:"un"},{label:"Tra",value:"tra"},{label:"Kg",value:"kg"}],"option-value":"value","option-label":"label","emit-value":"","map-options":""},null,8,["modelValue"]),i(r,{modelValue:o.cotizacioncemento.zona,"onUpdate:modelValue":e[8]||(e[8]=l=>o.cotizacioncemento.zona=l),filled:"",standout:"",label:"Zona",dense:"",outlined:"",options:o.zonas,"option-value":"nombre_zona","option-label":"nombre_zona","emit-value":"","map-options":""},null,8,["modelValue","options"]),i(c,{modelValue:o.cotizacioncemento.precio_compra_cf,"onUpdate:modelValue":e[9]||(e[9]=l=>o.cotizacioncemento.precio_compra_cf=l),label:"Precio Compra CF",type:"number",dense:"",outlined:""},null,8,["modelValue"]),i(c,{modelValue:o.cotizacioncemento.precio_compra_sf,"onUpdate:modelValue":e[10]||(e[10]=l=>o.cotizacioncemento.precio_compra_sf=l),label:"Precio Compra SF",type:"number",dense:"",outlined:""},null,8,["modelValue"]),i(c,{modelValue:o.cotizacioncemento.precio_venta_cf,"onUpdate:modelValue":e[11]||(e[11]=l=>o.cotizacioncemento.precio_venta_cf=l),label:"Precio Venta CF",type:"number",dense:"",outlined:""},null,8,["modelValue"]),i(c,{modelValue:o.cotizacioncemento.precio_venta_sf,"onUpdate:modelValue":e[12]||(e[12]=l=>o.cotizacioncemento.precio_venta_sf=l),label:"Precio Venta SF",type:"number",dense:"",outlined:""},null,8,["modelValue"]),i(c,{modelValue:o.cotizacioncemento.observacion,"onUpdate:modelValue":e[13]||(e[13]=l=>o.cotizacioncemento.observacion=l),label:"Observaci\xF3n",dense:"",outlined:"",type:"textarea"},null,8,["modelValue"]),_("div",B,[i(s,{color:"negative",label:"Cancelar",onClick:e[14]||(e[14]=l=>o.cotizacionDialog=!1),"no-caps":"",loading:o.loading},null,8,["loading"]),i(s,{color:"primary",label:"Guardar",type:"submit","no-caps":"",loading:o.loading,class:"q-ml-sm"},null,8,["loading"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var ie=G(M,[["render",O]]);export{ie as default};
