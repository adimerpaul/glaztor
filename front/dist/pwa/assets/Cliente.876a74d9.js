import{M as x,O as s,Y as m,R as o,Q as n,ax as S,_ as b,ay as E,az as g,S as c,aA as r,U as y,J as _,P as u,V as U,T as a,W as L,Z as C,aC as M,b0 as j,b1 as q}from"./index.5f1aaf33.js";import{d as p,e as Q,a as I,C as v}from"./ClosePopup.a953a791.js";import{Q as O}from"./QList.b0bf0ab1.js";import{Q as R,a as A,b as B}from"./QTable.488b5406.js";import{a as G,Q as h}from"./QSelect.4f82e7ea.js";import{Q as D}from"./QPage.ef24b83f.js";import{Q as Z}from"./QPageSticky.a6e1642a.js";import{Q as T,a as N}from"./QForm.cfb1bf6c.js";import{h as F}from"./moment.40bc58bf.js";import{i as Y,v as P,u as H}from"./vue-leaflet.es.7c495738.js";import{_ as W}from"./plugin-vue_export-helper.21dcd24c.js";import"./QBtnGroup.ad44aabe.js";import"./_commonjsHelpers.dffb1198.js";const J={name:"clientes",components:{LMap:Y,LTileLayer:P,LMarker:H},data(){return{dialogGlobal:!1,filter:"",columns:[{name:"actions",label:"Acciones",align:"center"},{name:"tipo_cliente",label:"Tipo cliente",align:"left",field:"tipo_cliente"},{name:"nombre_cliente",label:"Nombre",align:"left",field:"nombre_cliente"},{name:"telefono_1",label:"Telefono",align:"left",field:"telefono_1"},{name:"telefono_2",label:"Telefono 2",align:"left",field:"telefono_2"},{name:"direccion",label:"Direccion",align:"left",field:"direccion"},{name:"complemento",label:"Complemento",align:"left",field:"complemento"},{name:"ubicacion",label:"Ubicacion",align:"left",field:"ubicacion"},{name:"zona",label:"Zona",align:"left",field:"zona"},{name:"ejecutivo",label:"Ejecutivo",align:"left",field:"ejecutivo"},{name:"region",label:"Region",align:"left",field:"region"},{name:"cumple",label:"Cumplea\xF1os",align:"left",field:"cumple"},{name:"estado",label:"Estado",align:"left",field:"estado"}],tileProviders:[{name:"Mapa",visible:!0,url:"https://mt1.google.com/vt/lyrs=r&x={x}&y={y}&z={z}",attribution:"&copy; Google Maps"},{name:"Satelite",visible:!1,url:"https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",attribution:"&copy; Google Maps"}],location:[-17.969753,-67.114749],zoom:15,propietarioBtnBool:!0,encargadoBtnBool:!0,clientes:[],cliente:{},zonass:{zona_id:null},ejecutivoss:{ejecutivo_id:null},dialog:!1,loading:!1}},mounted(){this.getClientes(),this.getZonas(),this.getEjecutivos()},methods:{showGlobal(){this.dialogGlobal=!0},getZonas(){this.loading=!0,this.$axios.get("zonas").then(i=>{this.zonas=i.data.map(t=>({id:t.id,nombre_zona:t.nombre_zona}))}).catch(i=>{console.error("Error al obtener las zonas:",i),this.$q.notify({color:"negative",message:"Error al obtener las zonas. Intenta nuevamente.",icon:"report_problem"})}).finally(()=>{this.loading=!1})},getEjecutivos(){this.loading=!0,this.$axios.get("ejecutivos").then(i=>{this.ejecutivos=i.data.map(t=>({id:t.id,apodo:t.apodo}))}).catch(i=>{console.error("Error al obtener los ejecutivos:",i),this.$q.notify({color:"negative",message:"Error al obtener los ejecutivos. Intenta nuevamente.",icon:"report_problem"})}).finally(()=>{this.loading=!1})},showCliente(i){this.cliente=i,this.dialog=!0;const t=i.ubicacion.split(",").map(Number);console.log(t),this.location=t},onMarkerMoveEnd(i){const f=i.target.getLatLng();this.location=[f.lat,f.lng],this.cliente.ubicacion=`${f.lat.toFixed(7)}, ${f.lng.toFixed(7)}`},myLocation(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(i=>{this.location=[i.coords.latitude,i.coords.longitude],this.cliente.ubicacion=`${i.coords.latitude}, ${i.coords.longitude}`})},submit(){this.loading=!0,this.$axios.post("clientes",this.cliente).then(i=>{this.clientes.unshift(i.data),this.dialog=!1}).catch(i=>{console.log(i)}).finally(()=>{this.loading=!1})},dialogClick(){this.dialog=!0,this.cliente={tipo_cliente:"",nombre_cliente:"",telefono_1:"",telefono_2:"",direccion:"",complemento:"",ubicacion:"-17.969753, -67.114749",zona:"",region:"",cumple:F().format("YYYY-MM-DD"),estado:"ACTIVO"}},getClientes(){this.$axios.get("clientes").then(i=>{this.clientes=i.data}).catch(i=>{console.log(i)})}},computed:{esMovil(){return this.$q.screen.lt.md}}},K=i=>(j("data-v-7501cab2"),i=i(),q(),i),X={class:"text-h6"},$={class:"row"},ee={class:"col-12"},le={class:"col-12"},oe={class:"col-12"},te={class:"col-12"},ne={class:"col-12"},ie={class:"col-12"},ae={class:"col-12"},se={class:"col-12"},re={style:{height:"250px",width:"100%"}},ue={class:"col-12"},de={class:"col-12"},ce={class:"col-12"},me={class:"col-12"},pe={key:1,class:"row"},fe={class:"col-5"},be={style:{height:"150px",width:"100%"}},ge=K(()=>a("div",{class:"text-subtitle2"}," Vista de clientes ",-1)),_e={style:{height:"500px",width:"100%"}};function ve(i,t,f,he,l,d){const V=x("l-tile-layer"),k=x("l-marker"),z=x("l-map");return s(),m(b,null,[o(D,{class:"bg-grey-3 q-pa-xs"},{default:n(()=>[o(E,null,{default:n(()=>[o(g,{class:"q-pa-xs"},{default:n(()=>[o(R,{rows:l.clientes,columns:l.columns,dense:"","wrap-cells":"",flat:"",bordered:"","rows-per-page-options":[0],title:"Clientes",filter:l.filter},{"top-right":n(()=>[o(c,{color:"primary",label:"Mapa",onClick:d.showGlobal,outline:"","no-caps":"",icon:"public",loading:l.loading},null,8,["onClick","loading"]),o(r,{modelValue:l.filter,"onUpdate:modelValue":t[0]||(t[0]=e=>l.filter=e),label:"Buscar",dense:"",outlined:""},{append:n(()=>[o(y,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-actions":n(e=>[o(A,{props:e},{default:n(()=>[o(B,{label:"Opciones","no-caps":"",size:"10px",dense:"",color:"primary"},{default:n(()=>[o(O,null,{default:n(()=>[_((s(),u(I,{clickable:"",onClick:w=>i.userEdit(e.row)},{default:n(()=>[o(p,{avatar:""},{default:n(()=>[o(y,{name:"edit"})]),_:1}),o(p,null,{default:n(()=>[o(Q,null,{default:n(()=>[U("Editar")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[v]]),_((s(),u(I,{clickable:"",onClick:w=>i.userDelete(e.row.id)},{default:n(()=>[o(p,{avatar:""},{default:n(()=>[o(y,{name:"delete"})]),_:1}),o(p,null,{default:n(()=>[o(Q,null,{default:n(()=>[U("Eliminar")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[v]]),_((s(),u(I,{clickable:"",onClick:w=>i.userEditPassword(e.row)},{default:n(()=>[o(p,{avatar:""},{default:n(()=>[o(y,{name:"edit"})]),_:1}),o(p,null,{default:n(()=>[o(Q,null,{default:n(()=>[U("Cambiar contrase\xF1a")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[v]])]),_:2},1024)]),_:2},1024)]),_:2},1032,["props"])]),"body-cell-role":n(e=>[o(A,{props:e},{default:n(()=>[o(G,{label:e.row.role,color:e.row.role==="Administrador"?"primary":e.row.role==="Gerente"?"info":"positive","text-color":"white",dense:"",size:"14px"},null,8,["label","color"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","filter"])]),_:1})]),_:1})]),_:1}),o(Z,{position:"bottom-right",class:"text-bold",offset:[18,18]},{default:n(()=>[o(c,{fab:"",icon:"add",color:"primary",onClick:d.dialogClick},null,8,["onClick"])]),_:1}),o(S,{modelValue:l.dialog,"onUpdate:modelValue":t[19]||(t[19]=e=>l.dialog=e),position:d.esMovil?void 0:"right",maximized:!0,"transition-show":"slide-left","transition-hide":"slide-right"},{default:n(()=>[o(E,{style:{width:"450px","max-width":"100vw"}},{default:n(()=>[o(g,{class:"row items-center q-px-md bg-primary text-white q-px-none"},{default:n(()=>[_(o(c,{flat:"",round:"",dense:"",icon:"fa-solid fa-arrow-left"},null,512),[[v]]),o(T),a("div",X,L(l.cliente.id?"Editar":"Nuevo")+" cliente",1)]),_:1}),o(g,null,{default:n(()=>[l.cliente.id?(s(),m("div",pe,[a("div",fe,[a("div",be,[o(z,{ref:"map",zoom:l.zoom,"onUpdate:zoom":t[18]||(t[18]=e=>l.zoom=e),"use-global-leaflet":!1,center:l.location,scrollWheelZoom:!1,dragging:!1,touchZoom:!1,doubleClickZoom:!1,boxZoom:!1,keyboard:!1},{default:n(()=>[(s(!0),m(b,null,C(l.tileProviders,e=>(s(),u(V,{key:e.name,name:e.name,visible:e.visible,url:e.url,attribution:e.attribution,"layer-type":"base"},null,8,["name","visible","url","attribution"]))),128)),o(k,{"lat-lng":l.location,ref:"marker"},null,8,["lat-lng"])]),_:1},8,["zoom","center"])])])])):(s(),u(N,{key:0,onSubmit:d.submit},{default:n(()=>[a("div",$,[a("div",ee,[o(h,{dense:"",modelValue:l.cliente.tipo_cliente,"onUpdate:modelValue":t[1]||(t[1]=e=>l.cliente.tipo_cliente=e),options:["FERRETERIA","OBRA","EMPRESA CONSTRUCTORA"],outlined:"",rules:[e=>!!e||"Este campo es requerido"],label:"Tipo"},null,8,["modelValue","rules"])]),a("div",le,[o(r,{dense:"",modelValue:l.cliente.nombre_cliente,"onUpdate:modelValue":t[2]||(t[2]=e=>l.cliente.nombre_cliente=e),outlined:"",label:"Cliente",rules:[e=>!!e||"Este campo es requerido"],onInput:t[3]||(t[3]=e=>l.cliente.nombre_cliente=l.cliente.nombre_cliente.toUpperCase()),style:{"text-transform":"uppercase"}},null,8,["modelValue","rules"])]),a("div",oe,[o(r,{dense:"",modelValue:l.cliente.telefono_1,"onUpdate:modelValue":t[4]||(t[4]=e=>l.cliente.telefono_1=e),outlined:"",label:"Telefono cliente",type:"number",rules:[e=>!!e||"Este campo es requerido"]},null,8,["modelValue","rules"])]),a("div",te,[o(r,{dense:"",modelValue:l.cliente.telefono_2,"onUpdate:modelValue":t[5]||(t[5]=e=>l.cliente.telefono_2=e),outlined:"",label:"Telefono cliente 2",type:"number"},null,8,["modelValue"])]),a("div",ne,[o(r,{dense:"",modelValue:l.cliente.direccion,"onUpdate:modelValue":t[6]||(t[6]=e=>l.cliente.direccion=e),outlined:"",label:"Direcci\xF3n",rules:[e=>!!e||"Este campo es requerido"],onInput:t[7]||(t[7]=e=>l.cliente.direccion=l.cliente.direccion.toUpperCase()),style:{"text-transform":"uppercase"}},null,8,["modelValue","rules"])]),a("div",ie,[o(r,{dense:"",modelValue:l.cliente.complemento,"onUpdate:modelValue":t[8]||(t[8]=e=>l.cliente.complemento=e),outlined:"",label:"Complemento",onInput:t[9]||(t[9]=e=>l.cliente.complemento=l.cliente.complemento.toUpperCase()),style:{"text-transform":"uppercase"}},null,8,["modelValue"])]),a("div",ae,[o(r,{dense:"",modelValue:l.cliente.ubicacion,"onUpdate:modelValue":t[10]||(t[10]=e=>l.cliente.ubicacion=e),outlined:"",label:"Ubicacion"},{append:n(()=>[o(c,{flat:"",icon:"fa-solid fa-map-marker-alt",onClick:d.myLocation},null,8,["onClick"])]),_:1},8,["modelValue"])]),a("div",se,[a("div",re,[o(z,{ref:"map",zoom:l.zoom,"onUpdate:zoom":t[11]||(t[11]=e=>l.zoom=e),"use-global-leaflet":!1,center:l.location},{default:n(()=>[(s(!0),m(b,null,C(l.tileProviders,e=>(s(),u(V,{key:e.name,name:e.name,visible:e.visible,url:e.url,attribution:e.attribution,"layer-type":"base"},null,8,["name","visible","url","attribution"]))),128)),o(k,{"lat-lng":l.location,onMoveend:d.onMarkerMoveEnd,ref:"marker",draggable:!0},null,8,["lat-lng","onMoveend"])]),_:1},8,["zoom","center"])])]),a("div",ue,[o(h,{dense:"",modelValue:l.zonass.zona_id,"onUpdate:modelValue":t[12]||(t[12]=e=>l.zonass.zona_id=e),options:i.zonas,"option-label":"nombre_zona","option-value":"id",outlined:"",rules:[e=>!!e||"Este campo es requerido"],label:"Seleccionar Zona"},null,8,["modelValue","options","rules"])]),o(h,{dense:"",modelValue:l.ejecutivoss.ejecutivo_id,"onUpdate:modelValue":t[13]||(t[13]=e=>l.ejecutivoss.ejecutivo_id=e),options:i.ejecutivos,"option-label":"apodo","option-value":"id",outlined:"",rules:[e=>!!e||"Este campo es requerido"],label:"Seleccionar Ejecutivo"},null,8,["modelValue","options","rules"]),a("div",de,[o(h,{dense:"",modelValue:l.cliente.region,"onUpdate:modelValue":t[14]||(t[14]=e=>l.cliente.region=e),options:["ORURO","CHALLAPATA","COLQUIRI","POOPO","HUARI","SICA SICA","EUCALIPTUS"],outlined:"",rules:[e=>!!e||"Este campo es requerido"],label:"Region"},null,8,["modelValue","rules"])]),a("div",ce,[o(r,{dense:"",modelValue:l.cliente.cumple,"onUpdate:modelValue":t[15]||(t[15]=e=>l.cliente.cumple=e),outlined:"",label:"Cumplea\xF1os",type:"date"},null,8,["modelValue"])]),a("div",me,[o(h,{dense:"",modelValue:l.cliente.estado,"onUpdate:modelValue":t[16]||(t[16]=e=>l.cliente.estado=e),options:["ACTIVO","INACTIVO"],outlined:"",rules:[e=>!!e||"Este campo es requerido"],label:"Estado"},null,8,["modelValue","rules"])]),o(M,{align:"right"},{default:n(()=>[o(c,{label:"Cancelar",color:"negative",onClick:t[17]||(t[17]=e=>l.dialog=!1),loading:l.loading},null,8,["loading"]),o(c,{label:"Guardar",color:"primary",type:"submit",loading:l.loading},null,8,["loading"])]),_:1})])]),_:1},8,["onSubmit"]))]),_:1})]),_:1})]),_:1},8,["modelValue","position"]),o(S,{modelValue:l.dialogGlobal,"onUpdate:modelValue":t[21]||(t[21]=e=>l.dialogGlobal=e)},{default:n(()=>[o(E,{style:{width:"650px","max-width":"650px"}},{default:n(()=>[o(g,{class:"q-pa-md row items-center"},{default:n(()=>[ge,o(T),_(o(c,{flat:"",round:"",dense:"",icon:"close"},null,512),[[v]])]),_:1}),o(g,null,{default:n(()=>[a("div",_e,[o(z,{ref:"map",zoom:l.zoom,"onUpdate:zoom":t[20]||(t[20]=e=>l.zoom=e),"use-global-leaflet":!1,center:l.location},{default:n(()=>[(s(!0),m(b,null,C(l.tileProviders,e=>(s(),u(V,{key:e.name,name:e.name,visible:e.visible,url:e.url,attribution:e.attribution,"layer-type":"base"},null,8,["name","visible","url","attribution"]))),128)),(s(!0),m(b,null,C(l.clientes,e=>(s(),u(k,{key:e.id,"lat-lng":[parseFloat(e.lat),parseFloat(e.lng)],onClick:w=>d.showCliente(e)},null,8,["lat-lng","onClick"]))),128))]),_:1},8,["zoom","center"])])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}var Te=W(J,[["render",ve],["__scopeId","data-v-7501cab2"]]);export{Te as default};
