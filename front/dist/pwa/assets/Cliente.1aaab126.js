import{V as _,M as d,Z as u,Q as i,P as s,ay as k,$ as h,az as C,aA as b,X as t,_ as f,W as m,J as E,U as a,O as y,aB as r,aC as U,b0 as I,b1 as w}from"./index.18990dfe.js";import{Q as S}from"./QPage.635a648d.js";import{Q as A,a as g}from"./QSelect.aef4a2a1.js";import{_ as M,Q as L,a as Q}from"./plugin-vue_export-helper.b5fed559.js";import{C as j}from"./ClosePopup.e621342e.js";import{h as q}from"./moment.40bc58bf.js";import{i as T,v as O,u as R}from"./vue-leaflet.es.d77e9176.js";const B={name:"clientes",components:{LMap:T,LTileLayer:O,LMarker:R},data(){return{tileProviders:[{name:"Mapa",visible:!0,url:"https://mt1.google.com/vt/lyrs=r&x={x}&y={y}&z={z}",attribution:"&copy; Google Maps"},{name:"Satelite",visible:!1,url:"https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",attribution:"&copy; Google Maps"}],location:[-17.969753,-67.114749],zoom:15,propietarioBtnBool:!0,encargadoBtnBool:!0,clientes:[],cliente:{},zonass:{zona_id:null},ejecutivoss:{ejecutivo_id:null},dialog:!1,loading:!1}},mounted(){this.getClientes(),this.getZonas(),this.getEjecutivos()},methods:{getZonas(){this.loading=!0,this.$axios.get("zonas").then(n=>{this.zonas=n.data.map(o=>({id:o.id,nombre_zona:o.nombre_zona}))}).catch(n=>{console.error("Error al obtener las zonas:",n),this.$q.notify({color:"negative",message:"Error al obtener las zonas. Intenta nuevamente.",icon:"report_problem"})}).finally(()=>{this.loading=!1})},getEjecutivos(){this.loading=!0,this.$axios.get("ejecutivos").then(n=>{this.ejecutivos=n.data.map(o=>({id:o.id,apodo:o.apodo}))}).catch(n=>{console.error("Error al obtener los ejecutivos:",n),this.$q.notify({color:"negative",message:"Error al obtener los ejecutivos. Intenta nuevamente.",icon:"report_problem"})}).finally(()=>{this.loading=!1})},showCliente(n){this.cliente=n,this.dialog=!0;const o=n.ubicacion.split(",").map(Number);console.log(o),this.location=o},onMarkerMoveEnd(n){const c=n.target.getLatLng();this.location=[c.lat,c.lng],this.cliente.ubicacion=`${c.lat.toFixed(7)}, ${c.lng.toFixed(7)}`},myLocation(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(n=>{this.location=[n.coords.latitude,n.coords.longitude],this.cliente.ubicacion=`${n.coords.latitude}, ${n.coords.longitude}`})},submit(){this.loading=!0,this.$axios.post("clientes",this.cliente).then(n=>{this.clientes.push(n.data),this.dialog=!1}).catch(n=>{console.log(n)}).finally(()=>{this.loading=!1})},dialogClick(){this.dialog=!0,this.cliente={tipo_cliente:"",nombre_cliente:"",telefono_1:"",telefono_2:"",direccion:"",complemento:"",ubicacion:"-17.969753, -67.114749",zona:"",region:"",cumple:q().format("YYYY-MM-DD"),estado:"ACTIVO"}},getClientes(){this.$axios.get("clientes").then(n=>{this.clientes=n.data}).catch(n=>{console.log(n)})}},computed:{esMovil(){return this.$q.screen.lt.md}}},Z=n=>(I("data-v-8f91ce52"),n=n(),w(),n),D={border:"1",style:{width:"100%","border-collapse":"collapse"},class:"styled-table"},N=Z(()=>t("thead",null,[t("tr",null,[t("th",{style:{padding:"5px"}},"Tipo cliente"),t("th",{style:{padding:"5px"}},"Nombre"),t("th",{style:{padding:"5px"}},"Telefono"),t("th",{style:{padding:"5px"}},"Telefono 2"),t("th",{style:{padding:"5px"}},"Direccion"),t("th",{style:{padding:"5px"}},"Complemento"),t("th",{style:{width:"10%",padding:"5px"}},"Ubicacion"),t("th",{style:{padding:"5px"}},"Zona"),t("th",{style:{padding:"5px"}},"Ejecutivo"),t("th",{style:{padding:"5px"}},"Region"),t("th",{style:{padding:"5px"}},"Cumplea\xF1os"),t("th",{style:{padding:"5px"}},"Estado")])],-1)),F={style:{padding:"5px","line-height":"1.2"}},P={style:{padding:"5px","line-height":"1.2"}},Y={style:{padding:"5px","line-height":"1.2"}},G={style:{padding:"5px","line-height":"1.2"}},H={style:{padding:"5px","line-height":"1.2"}},W={style:{padding:"5px","line-height":"1.2"}},J={style:{padding:"2px","line-height":"1.2"}},X={style:{padding:"5px","line-height":"1.2"}},K={style:{padding:"5px","line-height":"1.2"}},$={style:{padding:"5px","line-height":"1.2"}},ee={style:{padding:"5px","line-height":"1.2"}},oe={style:{padding:"5px","line-height":"1.2"}},le={class:"text-h6"},te={class:"row"},ne={class:"col-12"},ie={class:"col-12"},se={class:"col-12"},ae={class:"col-12"},de={class:"col-12"},re={class:"col-12"},ue={class:"col-12"},ce={class:"col-12"},pe={style:{height:"250px",width:"100%"}},me={class:"col-12"},ge={class:"col-12"},he={class:"col-12"},_e={class:"col-12"},be={key:1,class:"row"},fe={class:"col-5"},ye={style:{height:"150px",width:"100%"}};function ve(n,o,c,xe,l,p){const v=_("l-tile-layer"),x=_("l-marker"),V=_("l-map");return d(),u(h,null,[i(S,{class:"bg-grey-3 q-pa-xs"},{default:s(()=>[i(C,null,{default:s(()=>[i(b,{class:"q-pa-xs"},{default:s(()=>[t("table",D,[N,t("tbody",null,[(d(!0),u(h,null,f(l.clientes,(e,z)=>(d(),u("tr",{key:z},[t("td",F,a(e.tipo_cliente),1),t("td",P,a(e.nombre_cliente),1),t("td",Y,a(e.telefono_1),1),t("td",G,a(e.telefono_2),1),t("td",H,a(e.direccion),1),t("td",W,a(e.complemento),1),t("td",J,a(e.ubicacion)+" ver ubicacion ",1),t("td",X,a(e.zona),1),t("td",K,a(e.ejecutivo),1),t("td",$,a(e.region),1),t("td",ee,a(e.cumple),1),t("td",oe,a(e.estado),1)]))),128))])])]),_:1})]),_:1})]),_:1}),i(A,{position:"bottom-right",class:"text-bold",offset:[18,18]},{default:s(()=>[i(m,{fab:"",icon:"add",color:"primary",onClick:p.dialogClick},null,8,["onClick"])]),_:1}),i(k,{modelValue:l.dialog,"onUpdate:modelValue":o[18]||(o[18]=e=>l.dialog=e),position:p.esMovil?void 0:"right",maximized:!0,"transition-show":"slide-left","transition-hide":"slide-right"},{default:s(()=>[i(C,{style:{width:"450px","max-width":"100vw"}},{default:s(()=>[i(b,{class:"row items-center q-px-md bg-primary text-white q-px-none"},{default:s(()=>[E(i(m,{flat:"",round:"",dense:"",icon:"fa-solid fa-arrow-left"},null,512),[[j]]),i(L),t("div",le,a(l.cliente.id?"Editar":"Nuevo")+" cliente",1)]),_:1}),i(b,null,{default:s(()=>[l.cliente.id?(d(),u("div",be,[t("div",fe,[t("div",ye,[i(V,{ref:"map",zoom:l.zoom,"onUpdate:zoom":o[17]||(o[17]=e=>l.zoom=e),"use-global-leaflet":!1,center:l.location,scrollWheelZoom:!1,dragging:!1,touchZoom:!1,doubleClickZoom:!1,boxZoom:!1,keyboard:!1},{default:s(()=>[(d(!0),u(h,null,f(l.tileProviders,e=>(d(),y(v,{key:e.name,name:e.name,visible:e.visible,url:e.url,attribution:e.attribution,"layer-type":"base"},null,8,["name","visible","url","attribution"]))),128)),i(x,{"lat-lng":l.location,ref:"marker"},null,8,["lat-lng"])]),_:1},8,["zoom","center"])])])])):(d(),y(Q,{key:0,onSubmit:p.submit},{default:s(()=>[t("div",te,[t("div",ne,[i(g,{dense:"",modelValue:l.cliente.tipo_cliente,"onUpdate:modelValue":o[0]||(o[0]=e=>l.cliente.tipo_cliente=e),options:["FERRETERIA","OBRA","EMPRESA CONSTRUCTORA"],outlined:"",rules:[e=>!!e||"Este campo es requerido"],label:"Tipo"},null,8,["modelValue","rules"])]),t("div",ie,[i(r,{dense:"",modelValue:l.cliente.nombre_cliente,"onUpdate:modelValue":o[1]||(o[1]=e=>l.cliente.nombre_cliente=e),outlined:"",label:"Cliente",rules:[e=>!!e||"Este campo es requerido"],onInput:o[2]||(o[2]=e=>l.cliente.nombre_cliente=l.cliente.nombre_cliente.toUpperCase()),style:{"text-transform":"uppercase"}},null,8,["modelValue","rules"])]),t("div",se,[i(r,{dense:"",modelValue:l.cliente.telefono_1,"onUpdate:modelValue":o[3]||(o[3]=e=>l.cliente.telefono_1=e),outlined:"",label:"Telefono cliente",type:"number",rules:[e=>!!e||"Este campo es requerido"]},null,8,["modelValue","rules"])]),t("div",ae,[i(r,{dense:"",modelValue:l.cliente.telefono_2,"onUpdate:modelValue":o[4]||(o[4]=e=>l.cliente.telefono_2=e),outlined:"",label:"Telefono cliente 2",type:"number"},null,8,["modelValue"])]),t("div",de,[i(r,{dense:"",modelValue:l.cliente.direccion,"onUpdate:modelValue":o[5]||(o[5]=e=>l.cliente.direccion=e),outlined:"",label:"Direcci\xF3n",rules:[e=>!!e||"Este campo es requerido"],onInput:o[6]||(o[6]=e=>l.cliente.direccion=l.cliente.direccion.toUpperCase()),style:{"text-transform":"uppercase"}},null,8,["modelValue","rules"])]),t("div",re,[i(r,{dense:"",modelValue:l.cliente.complemento,"onUpdate:modelValue":o[7]||(o[7]=e=>l.cliente.complemento=e),outlined:"",label:"Complemento",onInput:o[8]||(o[8]=e=>l.cliente.complemento=l.cliente.complemento.toUpperCase()),style:{"text-transform":"uppercase"}},null,8,["modelValue"])]),t("div",ue,[i(r,{dense:"",modelValue:l.cliente.ubicacion,"onUpdate:modelValue":o[9]||(o[9]=e=>l.cliente.ubicacion=e),outlined:"",label:"Ubicacion"},{append:s(()=>[i(m,{flat:"",icon:"fa-solid fa-map-marker-alt",onClick:p.myLocation},null,8,["onClick"])]),_:1},8,["modelValue"])]),t("div",ce,[t("div",pe,[i(V,{ref:"map",zoom:l.zoom,"onUpdate:zoom":o[10]||(o[10]=e=>l.zoom=e),"use-global-leaflet":!1,center:l.location},{default:s(()=>[(d(!0),u(h,null,f(l.tileProviders,e=>(d(),y(v,{key:e.name,name:e.name,visible:e.visible,url:e.url,attribution:e.attribution,"layer-type":"base"},null,8,["name","visible","url","attribution"]))),128)),i(x,{"lat-lng":l.location,onMoveend:p.onMarkerMoveEnd,ref:"marker",draggable:!0},null,8,["lat-lng","onMoveend"])]),_:1},8,["zoom","center"])])]),t("div",me,[i(g,{dense:"",modelValue:l.zonass.zona_id,"onUpdate:modelValue":o[11]||(o[11]=e=>l.zonass.zona_id=e),options:n.zonas,"option-label":"nombre_zona","option-value":"id",outlined:"",rules:[e=>!!e||"Este campo es requerido"],label:"Seleccionar Zona"},null,8,["modelValue","options","rules"])]),i(g,{dense:"",modelValue:l.ejecutivoss.ejecutivo_id,"onUpdate:modelValue":o[12]||(o[12]=e=>l.ejecutivoss.ejecutivo_id=e),options:n.ejecutivos,"option-label":"apodo","option-value":"id",outlined:"",rules:[e=>!!e||"Este campo es requerido"],label:"Seleccionar Ejecutivo"},null,8,["modelValue","options","rules"]),t("div",ge,[i(g,{dense:"",modelValue:l.cliente.region,"onUpdate:modelValue":o[13]||(o[13]=e=>l.cliente.region=e),options:["ORURO","CHALLAPATA","COLQUIRI","POOPO","HUARI","SICA SICA","EUCALIPTUS"],outlined:"",rules:[e=>!!e||"Este campo es requerido"],label:"Region"},null,8,["modelValue","rules"])]),t("div",he,[i(r,{dense:"",modelValue:l.cliente.cumple,"onUpdate:modelValue":o[14]||(o[14]=e=>l.cliente.cumple=e),outlined:"",label:"Cumplea\xF1os",type:"date"},null,8,["modelValue"])]),t("div",_e,[i(g,{dense:"",modelValue:l.cliente.estado,"onUpdate:modelValue":o[15]||(o[15]=e=>l.cliente.estado=e),options:["ACTIVO","INACTIVO"],outlined:"",rules:[e=>!!e||"Este campo es requerido"],label:"Estado"},null,8,["modelValue","rules"])]),i(U,{align:"right"},{default:s(()=>[i(m,{label:"Cancelar",color:"negative",onClick:o[16]||(o[16]=e=>l.dialog=!1),loading:l.loading},null,8,["loading"]),i(m,{label:"Guardar",color:"primary",type:"submit",loading:l.loading},null,8,["loading"])]),_:1})])]),_:1},8,["onSubmit"]))]),_:1})]),_:1})]),_:1},8,["modelValue","position"])],64)}var we=M(B,[["render",ve],["__scopeId","data-v-8f91ce52"]]);export{we as default};
