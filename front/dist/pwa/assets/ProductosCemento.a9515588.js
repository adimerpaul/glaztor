import{$ as u,a7 as p,a2 as a,a1 as r,aJ as q,a9 as C,aI as k,aG as h,a3 as g,a4 as t,a8 as N,C as b,a5 as i,bk as U,aH as c,b4 as F,a0 as P,F as x,a6 as v,aT as y,aK as S,bi as T,bj as A}from"./index.9c72f88d.js";import{Q,b as f}from"./format.89ba0050.js";import{Q as D}from"./QBtnDropdown.6f220dc2.js";import{Q as M}from"./QImg.ea271ccd.js";import{Q as _,a as O}from"./QSelect.d21464ce.js";import{Q as z}from"./QMarkupTable.cfe36cec.js";import{Q as B}from"./QPage.215302fc.js";import{Q as G}from"./QPageSticky.7a385ea6.js";import{Q as j}from"./QSpace.41e1f98e.js";import{Q as R}from"./QForm.a9dcb4d2.js";import{C as V}from"./ClosePopup.49e3c41f.js";import{E as L}from"./Excel.343f1006.js";import{_ as H}from"./plugin-vue_export-helper.21dcd24c.js";import"./QBtnGroup.33606e46.js";import"./index.a93ba69a.js";import"./_commonjsHelpers.a26ce4be.js";const J={name:"productocementos",data(){return{productocementos:[],productocemento:{},dialog:!1,loading:!1}},mounted(){this.getProductos()},methods:{aumentarPorTonelada(){this.$q.dialog({title:"Aumentar ",message:"\xBFEst\xE1s seguro de que deseas aumentar la cantidad ?",ok:{label:"S\xED",color:"primary"},cancel:{label:"No",color:"negative"},prompt:{model:"1",type:"number",label:"Cantidad a aumentar",rules:[s=>!!s||"Este campo es requerido"]}}).onOk(s=>{const o=parseInt(this.productocemento.tonelada);this.productocemento.cantidad=parseInt(s)*o+parseInt(this.productocemento.cantidad)})},exportExcel(){let s=[{sheet:"productocementos",columns:[{label:"Categoria Producto",value:"categoria"},{label:"Marca Producto",value:"marca"},{label:"Nombre Producto",value:"nombre"},{label:"Descripcion Producto",value:"descripcion"},{label:"Precio Producto",value:"precio"},{label:"Precio compra",value:"precio_compra"},{label:"Cantidad en Stok",value:"cantidad"},{label:"Tonelada por Producto",value:"tonelada"},{label:"Estado Producto",value:"estado"}],content:this.productocementos}];L.export(s,"Reporte de Productos ladrillo")},showProducto(s){this.productocemento={...s},this.dialog=!0},confirmarGuardar(){this.$q.dialog({title:"Confirmar Guardado",message:"\xBFEst\xE1s seguro de que quieres guardar los cambios?",ok:{label:"S\xED",color:"primary"},cancel:{label:"No",color:"negative"}}).onOk(()=>{this.submit()})},submit(){this.loading=!0,this.productocemento.id?this.$axios.put(`productosCemento/${this.productocemento.id}`,this.productocemento).then(s=>{const o=this.productocementos.findIndex(m=>m.id===this.productocemento.id);this.productocementos[o]=s.data,this.dialog=!1}).catch(s=>{console.log(s)}).finally(()=>{this.loading=!1}):this.$axios.post("productoscemento",this.productocemento).then(s=>{this.dialog=!1,this.productocementos.push(s.data)}).catch(s=>{this.$alert.error(s.response.data.message)}).finally(()=>{this.loading=!1})},eliminar(s){this.$q.dialog({title:"Confirmar Eliminaci\xF3n",message:"\xBFEst\xE1s seguro de que deseas eliminar este producto?",cancel:!0,persistent:!0}).onOk(()=>{this.$axios.delete(`productocementos/${s.id}`).then(o=>{this.productocementos=this.productocementos.filter(m=>m.id!==s.id)}).catch(o=>{console.log(o)})})},dialogClick(){this.dialog=!0,this.productocemento={categoria:"",marca:"",nombre:"",descripcion:"",precio:"",numeroPedido:"",numeroFactura:"",foto:"",estado:""}},getProductos(){this.$axios.get("productocementos").then(s=>{this.productocementos=s.data;const o=this.productocementos.some(n=>n.tonelada>0&&n.cantidad/n.tonelada<2),m=this.productocementos.filter(n=>n.cantidad&&n.tonelada&&n.cantidad/n.tonelada<2);if(m.length>0){const n=m.map(l=>l.nombre).join(", ");this.$q.dialog({title:"Inventario bajo",message:`Los siguientes productos est\xE1n agotados: ${n}`,ok:"Entendido"})}o&&this.$q.notify({color:"negative",icon:"warning",message:"Ya no hay inventario para algunos productos",position:"top",timeout:5e3})}).catch(s=>{console.log(s)})},previsualizarFoto(s){var o=new FileReader;o.readAsDataURL(s.target.files[0]),o.onload=()=>{this.foto=o.result,this.productocemento.foto=this.foto}}},computed:{esMovil(){return this.$q.screen.lt.md}}},E=s=>(T("data-v-19fd4d37"),s=s(),A(),s),K=E(()=>t("thead",null,[t("tr",null,[t("th",null,"Acciones"),t("th",null,"Nombre"),t("th",null,"Precio venta"),t("th",null,"Cantidad"),t("th",null,"Descripcion"),t("th",null,"Foto"),t("th",null,"Numero Pedido"),t("th",null,"Numero Factura"),t("th",null,"Estado"),t("th",null,"Categoria"),t("th",null,"Marca"),t("th",null,"Empresa")])],-1)),Y=["href"],W={class:"text-h6"},X={class:"row"},Z={class:"col-12"},$={class:"col-12"},ee={class:"col-12"},oe={class:"col-12"},te={class:"col-6"},le={class:"col-6"},ae={class:"col-12"},se={class:"col-6"},re={class:"col-6"},ne={class:"d-grid col-6 mx-auto mb-3"},ie=["src"],de={key:1,height:"100",src:"https://cdn4.iconfinder.com/data/icons/small-n-flat/24/user-256.png",class:"img-thumbnail",id:"fotoimg",alt:""},ue={class:"input-group mb-3"},ce=E(()=>t("span",{class:"input-group-text"},[t("i",{class:"fa-solid fa-gift"})],-1)),me={class:"col-12"},pe={class:"col-12"};function ge(s,o,m,n,l,d){return u(),p(C,null,[a(B,{class:"bg-grey-2"},{default:r(()=>[a(k,{flat:"",bordered:""},{default:r(()=>[a(h,{class:"q-pa-xs"},{default:r(()=>[a(g,{icon:"download",color:"green",label:"Exportar",onClick:d.exportExcel,"no-caps":""},null,8,["onClick"]),a(z,{dense:"","wrap-cells":""},{default:r(()=>[K,t("tbody",null,[(u(!0),p(C,null,N(l.productocementos,(e,I)=>(u(),p("tr",{key:I},[t("td",null,[a(D,{size:"10px",color:"primary","no-caps":"",label:"Opciones",dense:"",class:"q-mr-sm"},{default:r(()=>[b((u(),P(Q,{clickable:"",onClick:w=>d.showProducto(e)},{default:r(()=>[a(f,{avatar:""},{default:r(()=>[a(x,{name:"edit"})]),_:1}),a(f,null,{default:r(()=>[v("Editar")]),_:1})]),_:2},1032,["onClick"])),[[y],[V]]),b((u(),P(Q,{clickable:"",onClick:w=>d.showProducto(e)},{default:r(()=>[a(f,{avatar:""},{default:r(()=>[a(x,{name:"visibility"})]),_:1}),a(f,null,{default:r(()=>[v("Ver")]),_:1})]),_:2},1032,["onClick"])),[[y],[V]])]),_:2},1024)]),t("td",null,i(e.nombre),1),t("td",null,i(e.precio),1),t("td",null,i(e.cantidad),1),t("td",null,i(e.descripcion),1),t("td",null,[e.foto?(u(),p("a",{key:0,href:s.$url+".."+e.foto,target:"_blank"},[a(M,{src:s.$url+".."+e.foto,alt:"Imagen del producto",class:"img-thumbnail",height:"10"},null,8,["src"])],8,Y)):S("",!0)]),t("td",null,i(e.numeroPedido),1),t("td",null,i(e.numeroFactura),1),t("td",null,[a(O,{color:e.estado==="ACTIVO"?"green":"red","text-color":"white",dense:"",size:"10px"},{default:r(()=>[v(i(e.estado),1)]),_:2},1032,["color"])]),t("td",null,i(e.categoria),1),t("td",null,i(e.marca),1),t("td",null,i(e.empresa),1)]))),128))])]),_:1})]),_:1})]),_:1})]),_:1}),a(G,{position:"bottom-right",class:"text-bold",offset:[18,18]},{default:r(()=>[a(g,{fab:"",icon:"add",color:"primary",onClick:d.dialogClick},null,8,["onClick"])]),_:1}),a(q,{modelValue:l.dialog,"onUpdate:modelValue":o[16]||(o[16]=e=>l.dialog=e),position:d.esMovil?void 0:"right",maximized:!0,"transition-show":"slide-left","transition-hide":"slide-right"},{default:r(()=>[a(k,{style:{width:"450px","max-width":"100vw"}},{default:r(()=>[a(h,{class:"row items-center q-px-md bg-primary text-white q-px-none"},{default:r(()=>[b(a(g,{flat:"",round:"",dense:"",icon:"fa-solid fa-arrow-left"},null,512),[[V]]),a(j),t("div",W,i(l.productocemento.id?"Editar":"Nuevo")+" Producto cemento",1)]),_:1}),a(h,null,{default:r(()=>[a(R,{onSubmit:U(d.confirmarGuardar,["prevent"])},{default:r(()=>[t("div",X,[t("div",Z,[a(_,{dense:"",modelValue:l.productocemento.categoria,"onUpdate:modelValue":o[0]||(o[0]=e=>l.productocemento.categoria=e),options:["CEMENTO"],outlined:"",rules:[e=>!!e||"Este campo es requerido"],label:"Tipo"},null,8,["modelValue","rules"])]),t("div",$,[a(c,{dense:"",modelValue:l.productocemento.marca,"onUpdate:modelValue":o[1]||(o[1]=e=>l.productocemento.marca=e),outlined:"",label:"Marca",rules:[e=>!!e||"Este campo es requerido"],onInput:o[2]||(o[2]=e=>l.productocemento.marca=l.productocemento.marca.toUpperCase()),style:{"text-transform":"uppercase"}},null,8,["modelValue","rules"])]),t("div",ee,[a(c,{dense:"",modelValue:l.productocemento.nombre,"onUpdate:modelValue":o[3]||(o[3]=e=>l.productocemento.nombre=e),outlined:"",label:"Nombre Producto",rules:[e=>!!e||"Este campo es requerido"],onInput:o[4]||(o[4]=e=>l.productocemento.nombre=l.productocemento.nombre.toUpperCase()),style:{"text-transform":"uppercase"}},null,8,["modelValue","rules"])]),t("div",oe,[a(c,{dense:"",modelValue:l.productocemento.descripcion,"onUpdate:modelValue":o[5]||(o[5]=e=>l.productocemento.descripcion=e),outlined:"",label:"Descripcion Producto",onInput:o[6]||(o[6]=e=>l.productocemento.descripcion=l.productocemento.descripcion.toUpperCase()),hint:"",style:{"text-transform":"uppercase"}},null,8,["modelValue"])]),t("div",te,[a(c,{dense:"",modelValue:l.productocemento.precio,"onUpdate:modelValue":o[7]||(o[7]=e=>l.productocemento.precio=e),outlined:"",label:"Precio Venta",type:"number",hint:""},null,8,["modelValue"])]),t("div",le,[a(c,{dense:"",modelValue:l.productocemento.precio_compra,"onUpdate:modelValue":o[8]||(o[8]=e=>l.productocemento.precio_compra=e),outlined:"",label:"Precio Compra",type:"number",hint:""},null,8,["modelValue"])]),t("div",ae,[a(c,{dense:"",modelValue:l.productocemento.cantidad,"onUpdate:modelValue":o[9]||(o[9]=e=>l.productocemento.cantidad=e),outlined:"",label:"Cantidad en stok",type:"number",hint:""},{after:r(()=>[a(g,{round:"",color:"positive",icon:"add",onClick:d.aumentarPorTonelada},null,8,["onClick"])]),_:1},8,["modelValue"])]),t("div",se,[a(c,{dense:"",modelValue:l.productocemento.numeroPedido,"onUpdate:modelValue":o[10]||(o[10]=e=>l.productocemento.numeroPedido=e),outlined:"",label:"Numero de Pedido",hint:""},null,8,["modelValue"])]),t("div",re,[a(c,{dense:"",modelValue:l.productocemento.numeroFactura,"onUpdate:modelValue":o[11]||(o[11]=e=>l.productocemento.numeroFactura=e),outlined:"",label:"Numero de Factura",hint:""},null,8,["modelValue"])]),t("div",ne,[l.productocemento.foto?(u(),p("img",{key:0,src:l.productocemento.foto.includes("data")?l.productocemento.foto:s.$url+".."+l.productocemento.foto,alt:"Imagen del producto",class:"img-thumbnail",height:"100"},null,8,ie)):(u(),p("img",de))]),t("div",ue,[ce,t("input",{onChange:o[12]||(o[12]=(...e)=>d.previsualizarFoto&&d.previsualizarFoto(...e)),type:"file",accept:"image/png, image/jpg, image/gif",class:"form-control"},null,32)]),t("div",me,[a(_,{dense:"",modelValue:l.productocemento.estado,"onUpdate:modelValue":o[13]||(o[13]=e=>l.productocemento.estado=e),options:["ACTIVO","INACTIVO"],outlined:"",rules:[e=>!!e||"Este campo es requerido"],label:"Estado"},null,8,["modelValue","rules"])]),t("div",pe,[a(_,{dense:"",modelValue:l.productocemento.empresa,"onUpdate:modelValue":o[14]||(o[14]=e=>l.productocemento.empresa=e),options:["Glaztor","Valmar","Ambas"],outlined:"",rules:[e=>!!e||"Este campo es requerido"],label:"Empresa"},null,8,["modelValue","rules"])]),a(F,{align:"right"},{default:r(()=>[a(g,{label:"Cancelar",color:"negative",onClick:o[15]||(o[15]=e=>l.dialog=!1),loading:l.loading},null,8,["loading"]),a(g,{label:"Guardar",color:"primary",type:"submit",loading:l.loading},null,8,["loading"])]),_:1})])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue","position"])],64)}var Ne=H(J,[["render",ge],["__scopeId","data-v-19fd4d37"]]);export{Ne as default};
