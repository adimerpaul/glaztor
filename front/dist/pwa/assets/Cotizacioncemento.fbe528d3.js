import{$ as d,a0 as u,a1 as t,a2 as i,a3 as s,aH as c,F as p,C as b,a6 as g,aI as x,aG as h,a4 as v,a5 as Q,aJ as y}from"./index.accf20cf.js";import{Q as _,b as m,a as V}from"./format.bd4337e4.js";import{Q as D}from"./QList.321ce9c4.js";import{Q as k}from"./QBtnDropdown.f51cb189.js";import{Q as w}from"./QTd.7e67d2f8.js";import{Q as U}from"./QTable.4ca8fae1.js";import{Q as F}from"./QSpace.97ee4d87.js";import{Q as r}from"./QSelect.75d9adfb.js";import{Q as E}from"./QForm.74834cc1.js";import{Q as S}from"./QPage.3ff0f7ba.js";import{C}from"./ClosePopup.37988abf.js";import{h as A}from"./moment.40bc58bf.js";import{E as N}from"./Excel.343f1006.js";import{_ as G}from"./plugin-vue_export-helper.21dcd24c.js";import"./QBtnGroup.4d81c9b6.js";import"./QMarkupTable.975a4c67.js";import"./index.a93ba69a.js";import"./_commonjsHelpers.a26ce4be.js";const B={name:"CotizacionsPage",data(){return{cotizacioncementos:[],cotizacioncemento:{},cotizacionDialog:!1,loading:!1,productosAll:[],products:[],clientes:[],clientesAll:[],zonas:[],marcas:[],actionPeriodo:"",filter:"",columns:[{name:"actions",label:"Acciones",align:"center"},{name:"fecha",label:"Fecha",align:"left",field:"fecha"},{name:"cliente",label:"Cliente",align:"left",field:"cliente"},{name:"marca",label:"Marca",align:"left",field:"marca"},{name:"producto",label:"Producto",align:"left",field:"producto"},{name:"cantidad",label:"Cantidad",align:"left",field:"cantidad"},{name:"medida",label:"medida",align:"left",field:"medida"},{name:"zona",label:"Zona",align:"left",field:"zona"},{name:"precio_compra_cf",label:"Precio Compra CF",align:"left",field:"precio_compra_cf"},{name:"precio_compra_sf",label:"Precio Compra SF",align:"left",field:"precio_compra_sf"},{name:"precio_venta_cf",label:"Precio Venta CF",align:"left",field:"precio_venta_cf"},{name:"precio_venta_sf",label:"Precio Venta SF",align:"left",field:"precio_venta_sf"},{name:"observacion",label:"Observaci\xF3n",align:"left",field:"observacion"}]}},mounted(){this.cotizacionsGet(),this.getProductos(),this.getClientes(),this.getZonas()},methods:{exportExcel(){let a=[{sheet:"cotizacioncementos",columns:[{label:"Fecha",value:"fecha"},{label:"Nombre del cliente",value:"cliente"},{label:"Marca",value:"marca"},{label:"Producto",value:"producto"},{label:"Cantidad",value:"cantidad"},{label:"medida",value:"medida"},{label:"Zona",value:"zona"},{label:"Precio_compra_cf",value:"precio_compra_cf"},{label:"Precio_compra_sf",value:"precio_compra_sf"},{label:"Precio_venta_cf",value:"precio_venta_cf"},{label:"Precio_venta_sf",value:"precio_venta_sf"},{label:"Observacion",value:"observacion"}],content:this.cotizacioncementos}];N.export(a,"Reporte de Cotizaciones")},getZonas(){this.$axios.get("zonas").then(a=>{this.zonas=a.data}).catch(a=>{console.log(a)})},filterClientes(a,e){if(a===""){e(()=>{this.clientes=this.clientesAll});return}const f=a.toLowerCase();e(()=>{this.clientes=this.clientesAll.filter(z=>z.nombre_cliente.toLowerCase().indexOf(f)>-1)})},getClientes(){this.$axios.get("clientes").then(a=>{this.clientes=a.data,this.clientesAll=a.data}).catch(a=>{console.log(a)})},filterProducts(a){console.log(a),a!==null&&(this.products=this.productosAll.filter(e=>(e==null?void 0:e.marca)===a))},getProductos(){this.$axios.get("productocementos").then(a=>{this.productosAll=a.data,this.products=this.productosAll,this.products.forEach(e=>{this.marcas.includes(e.marca)||this.marcas.push(e.marca)})}).catch(a=>{console.log(a)})},cotizacionNew(){this.cotizacioncemento={fecha:A().format("YYYY-MM-DD"),cliente:"",marca:"",producto:"",cantidad:0,medida:"Un",zona:"",precio_compra_cf:0,precio_compra_sf:0,precio_venta_cf:0,precio_venta_sf:0,observacion:""},this.actionPeriodo="Nueva",this.cotizacionDialog=!0},cotizacionsGet(){this.loading=!0,this.$axios.get("cotizacioncementos").then(a=>{this.cotizacioncementos=a.data}).catch(a=>{this.$alert.error(a.response.data.message)}).finally(()=>{this.loading=!1})},cotizacionPost(){this.loading=!0,this.$axios.post("cotizacioncementos",this.cotizacioncemento).then(a=>{this.cotizacionsGet(),this.cotizacionDialog=!1,this.$alert.success("Cotizacion creada")}).catch(a=>{this.$alert.error(a.response.data.message)}).finally(()=>{this.loading=!1})},cotizacionPut(){this.loading=!0,this.$axios.put("cotizacioncementos/"+this.cotizacioncemento.id,this.cotizacioncemento).then(a=>{this.cotizacionsGet(),this.cotizacionDialog=!1,this.$alert.success("Cotizacion actualizada")}).catch(a=>{this.$alert.error(a.response.data.message)}).finally(()=>{this.loading=!1})},cotizacionEdit(a){this.cotizacioncemento={...a},this.actionPeriodo="Editar",this.cotizacionDialog=!0},cotizacionDelete(a){this.$alert.dialog("\xBFDesea eliminar la cotizacion?").onOk(()=>{this.loading=!0,this.$axios.delete("cotizacioncementos/"+a).then(e=>{this.cotizacionsGet(),this.$alert.success("Cotizacion eliminada")}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1})})}}},I={class:"text-right"};function M(a,e,f,z,o,n){return d(),u(S,{class:"q-pa-md"},{default:t(()=>[i(U,{rows:o.cotizacioncementos,columns:o.columns,dense:"","wrap-cells":"",flat:"",bordered:"","rows-per-page-options":[0],title:"cotizacioncementos",filter:o.filter},{"top-right":t(()=>[i(s,{icon:"download",color:"green",label:"Exportar",onClick:n.exportExcel,"no-caps":""},null,8,["onClick"]),i(s,{color:"primary",label:"Nuevo",onClick:n.cotizacionNew,outline:"","no-caps":"",icon:"add_circle_outline",loading:o.loading},null,8,["onClick","loading"]),i(c,{modelValue:o.filter,"onUpdate:modelValue":e[0]||(e[0]=l=>o.filter=l),label:"Buscar",dense:"",outlined:""},{append:t(()=>[i(p,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-actions":t(l=>[i(w,{props:l},{default:t(()=>[i(k,{label:"Opciones","no-caps":"",size:"10px",dense:"",color:"primary"},{default:t(()=>[i(D,null,{default:t(()=>[b((d(),u(_,{clickable:"",onClick:P=>n.cotizacionEdit(l.row)},{default:t(()=>[i(m,{avatar:""},{default:t(()=>[i(p,{name:"edit"})]),_:1}),i(m,null,{default:t(()=>[i(V,null,{default:t(()=>[g("Editar")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[C]]),b((d(),u(_,{clickable:"",onClick:P=>n.cotizacionDelete(l.row.id)},{default:t(()=>[i(m,{avatar:""},{default:t(()=>[i(p,{name:"delete"})]),_:1}),i(m,null,{default:t(()=>[i(V,null,{default:t(()=>[g("Eliminar")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[C]])]),_:2},1024)]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","columns","filter"]),i(y,{modelValue:o.cotizacionDialog,"onUpdate:modelValue":e[16]||(e[16]=l=>o.cotizacionDialog=l),persistent:""},{default:t(()=>[i(x,{style:{"min-width":"350px","max-width":"800px"}},{default:t(()=>[i(h,{class:"q-pb-none row items-center"},{default:t(()=>[v("div",null,Q(o.actionPeriodo)+" Cotizacion ",1),i(F),i(s,{icon:"close",flat:"",round:"",dense:"",onClick:e[1]||(e[1]=l=>o.cotizacionDialog=!1)})]),_:1}),i(h,{class:"q-pt-none"},{default:t(()=>[i(E,{onSubmit:e[15]||(e[15]=l=>o.cotizacioncemento.id?n.cotizacionPut():n.cotizacionPost())},{default:t(()=>[i(c,{modelValue:o.cotizacioncemento.fecha,"onUpdate:modelValue":e[2]||(e[2]=l=>o.cotizacioncemento.fecha=l),label:"Fecha",dense:"",outlined:"",type:"date",disable:!0},null,8,["modelValue"]),i(r,{modelValue:o.cotizacioncemento.cliente,"onUpdate:modelValue":e[3]||(e[3]=l=>o.cotizacioncemento.cliente=l),onFilter:n.filterClientes,rules:[l=>!!l||"Seleccione un cliente"],filled:"","emit-value":"","map-options":"",standout:"","use-input":"",label:"Cliente",options:o.clientes,"option-value":"id","option-label":"nombre_cliente",dense:"",clearable:""},null,8,["modelValue","onFilter","rules","options"]),i(r,{modelValue:o.cotizacioncemento.marca,"onUpdate:modelValue":[e[4]||(e[4]=l=>o.cotizacioncemento.marca=l),n.filterProducts],label:"Marca",dense:"",outlined:"","use-input":"",options:o.marcas},null,8,["modelValue","onUpdate:modelValue","options"]),i(r,{modelValue:o.cotizacioncemento.producto,"onUpdate:modelValue":e[5]||(e[5]=l=>o.cotizacioncemento.producto=l),label:"Producto",dense:"",outlined:"","use-input":"","option-label":"nombre","option-value":"nombre","emit-value":"","map-options":"",options:o.products},null,8,["modelValue","options"]),i(c,{modelValue:o.cotizacioncemento.cantidad,"onUpdate:modelValue":e[6]||(e[6]=l=>o.cotizacioncemento.cantidad=l),label:"Cantidad",type:"number",dense:"",outlined:"",rules:[l=>!!l||"Campo requerido"]},null,8,["modelValue","rules"]),i(r,{modelValue:o.cotizacioncemento.medida,"onUpdate:modelValue":e[7]||(e[7]=l=>o.cotizacioncemento.medida=l),filled:"",standout:"",label:"Medida",dense:"",outlined:"",options:[{label:"Un",value:"un"},{label:"Tra",value:"tra"},{label:"Kg",value:"kg"}],"option-value":"value","option-label":"label","emit-value":"","map-options":""},null,8,["modelValue"]),i(r,{modelValue:o.cotizacioncemento.zona,"onUpdate:modelValue":e[8]||(e[8]=l=>o.cotizacioncemento.zona=l),filled:"",standout:"",label:"Zona",dense:"",outlined:"",options:o.zonas,"option-value":"nombre_zona","option-label":"nombre_zona","emit-value":"","map-options":""},null,8,["modelValue","options"]),i(c,{modelValue:o.cotizacioncemento.precio_compra_cf,"onUpdate:modelValue":e[9]||(e[9]=l=>o.cotizacioncemento.precio_compra_cf=l),label:"Precio Compra CF",type:"number",dense:"",outlined:""},null,8,["modelValue"]),i(c,{modelValue:o.cotizacioncemento.precio_compra_sf,"onUpdate:modelValue":e[10]||(e[10]=l=>o.cotizacioncemento.precio_compra_sf=l),label:"Precio Compra SF",type:"number",dense:"",outlined:""},null,8,["modelValue"]),i(c,{modelValue:o.cotizacioncemento.precio_venta_cf,"onUpdate:modelValue":e[11]||(e[11]=l=>o.cotizacioncemento.precio_venta_cf=l),label:"Precio Venta CF",type:"number",dense:"",outlined:""},null,8,["modelValue"]),i(c,{modelValue:o.cotizacioncemento.precio_venta_sf,"onUpdate:modelValue":e[12]||(e[12]=l=>o.cotizacioncemento.precio_venta_sf=l),label:"Precio Venta SF",type:"number",dense:"",outlined:""},null,8,["modelValue"]),i(c,{modelValue:o.cotizacioncemento.observacion,"onUpdate:modelValue":e[13]||(e[13]=l=>o.cotizacioncemento.observacion=l),label:"Observaci\xF3n",dense:"",outlined:"",type:"textarea"},null,8,["modelValue"]),v("div",I,[i(s,{color:"negative",label:"Cancelar",onClick:e[14]||(e[14]=l=>o.cotizacionDialog=!1),"no-caps":"",loading:o.loading},null,8,["loading"]),i(s,{color:"primary",label:"Guardar",type:"submit","no-caps":"",loading:o.loading,class:"q-ml-sm"},null,8,["loading"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var ae=G(B,[["render",M]]);export{ae as default};
