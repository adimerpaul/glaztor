import{$ as c,a0 as m,a1 as i,a2 as t,aG as p,a3 as r,a4 as d,C as _,F as v,a6 as h,aI as f,a5 as C,bk as w,aH as u,b4 as Q,aJ as A,aT as V}from"./index.9c72f88d.js";import{Q as S,b as y}from"./format.89ba0050.js";import{Q as U}from"./QBtnDropdown.6f220dc2.js";import{Q as j}from"./QTable.4e618a11.js";import{Q as q}from"./QSpace.41e1f98e.js";import{Q as x}from"./QSelect.d21464ce.js";import{Q as k}from"./QForm.a9dcb4d2.js";import{Q as E}from"./QPage.215302fc.js";import{C as b}from"./ClosePopup.49e3c41f.js";import{h as D}from"./moment.40bc58bf.js";import{E as T}from"./Excel.343f1006.js";import{_ as P}from"./plugin-vue_export-helper.21dcd24c.js";import"./QBtnGroup.33606e46.js";import"./QList.12c1a32d.js";import"./QMarkupTable.cfe36cec.js";import"./index.a93ba69a.js";import"./_commonjsHelpers.a26ce4be.js";const I={name:"sueldos",data(){return{sueldos:[],sueldo:{},ejecutivos:[],ejecutivosAll:[],dialog:!1,loading:!1}},mounted(){this.getSueldos(),this.getEjecutivos()},computed:{montoAcumulado(){return parseFloat(this.sueldo.haber_basico||0)+parseFloat(this.sueldo.bono_antiguedad||0)},descuentoAFP(){return(this.montoAcumulado*.005).toFixed(2)},descuentoSeguro(){return(this.montoAcumulado*.1).toFixed(2)},descuentoSolidario(){return(this.montoAcumulado*.0171).toFixed(2)},descuentoOtros(){return(this.montoAcumulado*.005).toFixed(2)},totalDescuentosLab(){return(parseFloat(this.descuentoAFP)+parseFloat(this.descuentoSeguro)+parseFloat(this.descuentoSolidario)+parseFloat(this.descuentoOtros)).toFixed(2)},liquido(){return(parseFloat(this.montoAcumulado||0)-parseFloat(this.totalDescuentosLab||0)).toFixed(2)},liquidoPagable(){return parseFloat(this.sueldo.total_liquido||0)-parseFloat(this.sueldo.total_descuentos||0)}},watch:{montoAcumulado(s){this.sueldo.monto_acumulado=s},descuentoAFP(s){this.sueldo.descuento_afp=s},descuentoSeguro(s){this.sueldo.descuento_seguro=s},descuentoSolidario(s){this.sueldo.descuento_solidario=s},descuentoOtros(s){this.sueldo.descuento_otros=s},totalDescuentosLab(s){this.sueldo.total_descuentos_lab=s},liquido(s){this.sueldo.total_liquido=s},liquidoPagable(s){this.sueldo.liquido_pagable=s}},methods:{exportExcel(){let s=[{sheet:"Sueldos",columns:[{label:"sueldo correspondiente al mes",value:"sueldo_correspondiente"},{label:"tipo de Contrato",value:"tipo"},{label:"Nombre Completo",value:"nombre_completo"},{label:"Ci",value:"ci"},{label:"Cargo",value:"cargo"},{label:"Fecha de Ingreso",value:"fecha_ingreso"},{label:"Haber Basico",value:"haber_basico"},{label:"Bono Antiguedad",value:"bono_antiguedad"},{label:"Monto Acumulado",value:"monto_acumulado"},{label:"Descuento afp",value:"descuento_afp"},{label:"Descuento Seguro",value:"descuento_seguro"},{label:"Descuento Solidario",value:"descuento_solidario"},{label:"Descuento Otros",value:"descuento_otros"},{label:"Total descuentos lab",value:"total_descuentos_lab"},{label:"Total liquido",value:"total_liquido"},{label:"Descuento rc iva",value:"descuento_rc_iva"},{label:"Descuento Anticipogo",value:"descuento_anticipo"},{label:"Total descuentos",value:"total_descuentos"},{label:"Liquido Pagable",value:"liquido_pagable"}],content:this.sueldos}];T.export(s,"Reporte de Sueldos")},changeDirecionTelefono(s){const e=this.ejecutivos.find(n=>n.id===s);this.sueldo.ci=e.ci,this.sueldo.cargo=e.cargo},openDialog(){this.dialog=!0,this.sueldo={sueldo_correspondiente:D().format("YYYY-MM-DD"),tipo:"",nombre_completo:"",ci:"",cargo:"",fecha_ingreso:D().format("YYYY-MM-DD"),haber_basico:0,bono_antiguedad:0,monto_acumulado:0,descuento_afp:0,descuento_seguro:0,total_descuentos:0,descuento_rc_iva:0,descuento_anticipo:0,liquido_pagable:0}},filterEjecutivos(s,e){if(s===""){e(()=>{this.ejecutivos=this.ejecutivosAll});return}const n=s.toLowerCase();e(()=>{this.ejecutivos=this.ejecutivosAll.filter(g=>g.nombre_eje.toLowerCase().indexOf(n)>-1)})},getEjecutivos(){this.$axios.get("ejecutivos").then(s=>{this.ejecutivos=s.data,this.ejecutivosAll=s.data}).catch(s=>{console.log(s)})},editSueldo(s){this.sueldo={...s},this.dialog=!0},saveSueldo(){this.sueldo.id?this.updateSueldo():this.addSueldo()},addSueldo(){this.loading=!0,this.$axios.post("sueldos",this.sueldo).then(s=>{this.sueldos.push(s.data),this.dialog=!1}).catch(s=>{this.$alert.error(s.response.data.message)}).finally(()=>{this.loading=!1})},updateSueldo(){this.$axios.put(`sueldos/${this.sueldo.id}`,this.sueldo).then(s=>{const e=this.sueldos.findIndex(n=>n.id===this.sueldo.id);this.sueldos[e]=s.data,this.dialog=!1})},deleteSueldo(s){this.$axios.delete(`sueldos/${s.id}`).then(()=>{this.sueldos=this.sueldos.filter(e=>e.id!==s.id)})},getSueldos(){this.$axios.get("sueldos").then(s=>{this.sueldos=s.data})}}},N={class:"col-6 col-md-4 text-right"},B={class:"text-h6"},L={class:"col-12"},M={class:"row q-col-gutter-md"},O={class:"col-12"},Y={class:"col-12"},R={class:"col-6"},G={class:"col-6"},H={class:"col-12"},J={class:"col-6"},z={class:"col-6"},K={class:"col-12"},W={class:"col-6"},X={class:"col-6"},Z={class:"col-6"},$={class:"col-6"},ee={class:"col-12"},oe={class:"col-12"},le={class:"col-6"},se={class:"col-6"},te={class:"col-12"},de={class:"col-12"};function ue(s,e,n,g,o,a){return c(),m(E,{class:"bg-grey-2"},{default:i(()=>[t(f,{flat:"",bordered:""},{default:i(()=>[t(p,null,{default:i(()=>[t(j,{flat:"",bordered:"",dense:"",rows:o.sueldos,"row-key":"id",columns:s.columns,class:"styled-table","hide-bottom":""},{"top-right":i(()=>[t(r,{icon:"add",label:"Nuevo Sueldo",color:"primary",onClick:a.openDialog},null,8,["onClick"]),d("div",N,[t(r,{icon:"download",color:"green",label:"Exportar",onClick:a.exportExcel,"no-caps":""},null,8,["onClick"])])]),"body-cell-acciones":i(l=>[t(U,{flat:"",dense:"",color:"primary","no-caps":"",label:"Opciones"},{default:i(()=>[_((c(),m(S,{clickable:"",onClick:F=>a.editSueldo(l.row)},{default:i(()=>[t(y,null,{default:i(()=>[t(v,{name:"edit"}),h(" Editar ")]),_:1})]),_:2},1032,["onClick"])),[[V],[b]]),_((c(),m(S,{clickable:"",onClick:F=>a.deleteSueldo(l.row)},{default:i(()=>[t(y,null,{default:i(()=>[t(v,{name:"delete"}),h(" Eliminar ")]),_:1})]),_:2},1032,["onClick"])),[[V],[b]])]),_:2},1024)]),_:1},8,["rows","columns"])]),_:1})]),_:1}),t(A,{modelValue:o.dialog,"onUpdate:modelValue":e[20]||(e[20]=l=>o.dialog=l),"transition-show":"slide-up","transition-hide":"slide-down"},{default:i(()=>[t(f,{style:{width:"500px","max-width":"100vw"}},{default:i(()=>[t(p,{class:"row items-center bg-primary text-white"},{default:i(()=>[_(t(r,{flat:"",round:"",dense:"",icon:"arrow_back"},null,512),[[b]]),t(q),d("div",B,C(o.sueldo.id?"Editar Sueldo":"Nuevo Sueldo"),1)]),_:1}),t(p,null,{default:i(()=>[t(k,{onSubmit:w(a.saveSueldo,["prevent"])},{default:i(()=>[d("div",L,[t(u,{dense:"",modelValue:o.sueldo.sueldo_correspondiente,"onUpdate:modelValue":e[0]||(e[0]=l=>o.sueldo.sueldo_correspondiente=l),type:"date",outlined:"",label:"sueldo Correspondiente"},null,8,["modelValue"])]),d("div",M,[d("div",O,[t(x,{dense:"",modelValue:o.sueldo.tipo,"onUpdate:modelValue":e[1]||(e[1]=l=>o.sueldo.tipo=l),options:["PERMANENTE","TEMPORAL"],outlined:"",label:"Tipo"},null,8,["modelValue"])]),d("div",Y,[t(x,{modelValue:o.sueldo.ejecutivo_id,"onUpdate:modelValue":[e[2]||(e[2]=l=>o.sueldo.ejecutivo_id=l),a.changeDirecionTelefono],onFilter:a.filterEjecutivos,rules:[l=>!!l||"Seleccione un cliente"],filled:"","emit-value":"","map-options":"",standout:"","use-input":"",label:"Nombre",options:o.ejecutivos,"option-value":"id","option-label":"nombre_eje",dense:"",clearable:""},null,8,["modelValue","onFilter","onUpdate:modelValue","rules","options"])]),d("div",R,[t(u,{dense:"",modelValue:o.sueldo.ci,"onUpdate:modelValue":e[3]||(e[3]=l=>o.sueldo.ci=l),outlined:"",label:"C.I."},null,8,["modelValue"])]),d("div",G,[t(u,{dense:"",modelValue:o.sueldo.cargo,"onUpdate:modelValue":e[4]||(e[4]=l=>o.sueldo.cargo=l),outlined:"",label:"Cargo"},null,8,["modelValue"])]),d("div",H,[t(u,{dense:"",modelValue:o.sueldo.fecha_ingreso,"onUpdate:modelValue":e[5]||(e[5]=l=>o.sueldo.fecha_ingreso=l),type:"date",outlined:"",label:"Fecha de Ingreso"},null,8,["modelValue"])]),d("div",J,[t(u,{dense:"",modelValue:o.sueldo.haber_basico,"onUpdate:modelValue":e[6]||(e[6]=l=>o.sueldo.haber_basico=l),outlined:"",type:"number",label:"Haber B\xE1sico"},null,8,["modelValue"])]),d("div",z,[t(u,{dense:"",modelValue:o.sueldo.bono_antiguedad,"onUpdate:modelValue":e[7]||(e[7]=l=>o.sueldo.bono_antiguedad=l),outlined:"",type:"number",label:"bono antiguedad"},null,8,["modelValue"])]),d("div",K,[t(u,{dense:"",modelValue:o.sueldo.monto_acumulado,"onUpdate:modelValue":e[8]||(e[8]=l=>o.sueldo.monto_acumulado=l),outlined:"",type:"number",label:"total Ganado",readonly:""},null,8,["modelValue"])]),d("div",W,[t(u,{dense:"",modelValue:o.sueldo.descuento_afp,"onUpdate:modelValue":e[9]||(e[9]=l=>o.sueldo.descuento_afp=l),outlined:"",type:"number",label:"Descuento AFP (0.5%)",readonly:""},null,8,["modelValue"])]),d("div",X,[t(u,{dense:"",modelValue:o.sueldo.descuento_seguro,"onUpdate:modelValue":e[10]||(e[10]=l=>o.sueldo.descuento_seguro=l),outlined:"",type:"number",label:"Descuento Seguro"},null,8,["modelValue"])]),d("div",Z,[t(u,{dense:"",modelValue:o.sueldo.descuento_solidario,"onUpdate:modelValue":e[11]||(e[11]=l=>o.sueldo.descuento_solidario=l),outlined:"",type:"number",label:"Descuento Solidario"},null,8,["modelValue"])]),d("div",$,[t(u,{dense:"",modelValue:o.sueldo.descuento_otros,"onUpdate:modelValue":e[12]||(e[12]=l=>o.sueldo.descuento_otros=l),outlined:"",type:"number",label:"Descuento Otros"},null,8,["modelValue"])]),d("div",ee,[t(u,{dense:"",modelValue:o.sueldo.total_descuentos_lab,"onUpdate:modelValue":e[13]||(e[13]=l=>o.sueldo.total_descuentos_lab=l),outlined:"",type:"number",label:"Total Descuento"},null,8,["modelValue"])]),d("div",oe,[t(u,{dense:"",modelValue:o.sueldo.total_liquido,"onUpdate:modelValue":e[14]||(e[14]=l=>o.sueldo.total_liquido=l),outlined:"",type:"number",label:"total liquido",readonly:""},null,8,["modelValue"])]),d("div",le,[t(u,{dense:"",modelValue:o.sueldo.descuento_rc_iva,"onUpdate:modelValue":e[15]||(e[15]=l=>o.sueldo.descuento_rc_iva=l),outlined:"",type:"number",label:"Descuento rc_iva"},null,8,["modelValue"])]),d("div",se,[t(u,{dense:"",modelValue:o.sueldo.descuento_anticipo,"onUpdate:modelValue":e[16]||(e[16]=l=>o.sueldo.descuento_anticipo=l),outlined:"",type:"number",label:"Descuento anticipo	"},null,8,["modelValue"])]),d("div",te,[t(u,{dense:"",modelValue:o.sueldo.total_descuentos,"onUpdate:modelValue":e[17]||(e[17]=l=>o.sueldo.total_descuentos=l),outlined:"",type:"number",label:"Total Descuento	"},null,8,["modelValue"])]),d("div",de,[t(u,{dense:"",modelValue:o.sueldo.liquido_pagable,"onUpdate:modelValue":e[18]||(e[18]=l=>o.sueldo.liquido_pagable=l),outlined:"",type:"number",label:"L\xEDquido Pagable"},null,8,["modelValue"])])]),t(Q,{align:"right"},{default:i(()=>[t(r,{label:"Cancelar",flat:"",color:"negative",onClick:e[19]||(e[19]=l=>o.dialog=!1),loading:o.loading},null,8,["loading"]),t(r,{label:"Guardar",flat:"",color:"primary",type:"submit",loading:o.loading},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var De=P(I,[["render",ue],["__scopeId","data-v-64ca19f6"]]);export{De as default};
