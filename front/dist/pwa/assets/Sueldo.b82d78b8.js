import{R as r,S as m,T as i,U as t,aA as p,V as c,M as _,X as h,Y as f,aC as v,W as d,Z as U,bf as j,aB as u,$ as V,a_ as C,aD as Q,aJ as S,b2 as A,b3 as k}from"./index.14a741ef.js";import{a as y,d as F,C as b}from"./ClosePopup.b46939d4.js";import{Q as q}from"./QBtnDropdown.eb932f31.js";import{Q as E}from"./QTable.9a4be4b6.js";import{Q as I,a as P}from"./QForm.52148441.js";import{Q as D}from"./QSelect.2c61fcd1.js";import{Q as T}from"./QPage.45f73780.js";import{h as w}from"./moment.40bc58bf.js";import{_ as Y}from"./plugin-vue_export-helper.21dcd24c.js";import"./QBtnGroup.b452f0a9.js";import"./QList.7da70530.js";import"./QMarkupTable.c9a1407f.js";const B={name:"sueldos",data(){return{sueldos:[],sueldo:{},ejecutivos:[],ejecutivosAll:[],dialog:!1,loading:!1}},mounted(){this.getSueldos(),this.getEjecutivos()},computed:{montoAcumulado(){return parseFloat(this.sueldo.haber_basico||0)+parseFloat(this.sueldo.bono_antiguedad||0)},descuentoAFP(){return(this.montoAcumulado*.005).toFixed(2)},descuentoSeguro(){return(this.montoAcumulado*.1).toFixed(2)},descuentoSolidario(){return(this.montoAcumulado*.0171).toFixed(2)},descuentoOtros(){return(this.montoAcumulado*.005).toFixed(2)},totalDescuentosLab(){return(parseFloat(this.descuentoAFP)+parseFloat(this.descuentoSeguro)+parseFloat(this.descuentoSolidario)+parseFloat(this.descuentoOtros)).toFixed(2)},liquido(){return(parseFloat(this.montoAcumulado||0)-parseFloat(this.totalDescuentosLab||0)).toFixed(2)},liquidoPagable(){return parseFloat(this.sueldo.total_liquido||0)-parseFloat(this.sueldo.total_descuentos||0)}},watch:{montoAcumulado(l){this.sueldo.monto_acumulado=l},descuentoAFP(l){this.sueldo.descuento_afp=l},descuentoSeguro(l){this.sueldo.descuento_seguro=l},descuentoSolidario(l){this.sueldo.descuento_solidario=l},descuentoOtros(l){this.sueldo.descuento_otros=l},totalDescuentosLab(l){this.sueldo.total_descuentos_lab=l},liquido(l){this.sueldo.total_liquido=l},liquidoPagable(l){this.sueldo.liquido_pagable=l}},methods:{changeDirecionTelefono(l){const e=this.ejecutivos.find(n=>n.id===l);this.sueldo.ci=e.ci,this.sueldo.cargo=e.cargo},openDialog(){this.dialog=!0,this.sueldo={sueldo_correspondiente:w().format("YYYY-MM-DD"),tipo:"",nombre_completo:"",ci:"",cargo:"",fecha_ingreso:w().format("YYYY-MM-DD"),haber_basico:0,bono_antiguedad:0,monto_acumulado:0,descuento_afp:0,descuento_seguro:0,total_descuentos:0,descuento_rc_iva:0,descuento_anticipo:0,liquido_pagable:0}},filterEjecutivos(l,e){if(l===""){e(()=>{this.ejecutivos=this.ejecutivosAll});return}const n=l.toLowerCase();e(()=>{this.ejecutivos=this.ejecutivosAll.filter(g=>g.nombre_eje.toLowerCase().indexOf(n)>-1)})},getEjecutivos(){this.$axios.get("ejecutivos").then(l=>{this.ejecutivos=l.data,this.ejecutivosAll=l.data}).catch(l=>{console.log(l)})},editSueldo(l){this.sueldo={...l},this.dialog=!0},saveSueldo(){this.sueldo.id?this.updateSueldo():this.addSueldo()},addSueldo(){this.loading=!0,this.$axios.post("sueldos",this.sueldo).then(l=>{this.sueldos.push(l.data),this.dialog=!1}).catch(l=>{this.$alert.error(l.response.data.message)}).finally(()=>{this.loading=!1})},updateSueldo(){this.$axios.put(`sueldos/${this.sueldo.id}`,this.sueldo).then(l=>{const e=this.sueldos.findIndex(n=>n.id===this.sueldo.id);this.sueldos[e]=l.data,this.dialog=!1})},deleteSueldo(l){this.$axios.delete(`sueldos/${l.id}`).then(()=>{this.sueldos=this.sueldos.filter(e=>e.id!==l.id)})},getSueldos(){this.$axios.get("sueldos").then(l=>{this.sueldos=l.data})}}},M=l=>(A("data-v-61e73e2b"),l=l(),k(),l),N={class:"text-h6"},L={class:"col-12"},O={class:"row q-col-gutter-md"},R={class:"col-12"},z={class:"col-12"},G={class:"col-6"},H={class:"col-6"},J={class:"col-12"},W={class:"col-6"},X={class:"col-6"},Z={class:"col-12"},K={class:"col-6"},$={class:"col-6"},ee={class:"col-6"},oe={class:"col-6"},le={class:"col-12"},se={class:"col-12"},te={class:"col-6"},de={class:"col-6"},ue={class:"col-12"},ie={class:"col-12"},ne={class:"d-grid col-6 mx-auto mb-3"},ae=["src"],re={key:1,height:"100",src:"https://cdn4.iconfinder.com/data/icons/small-n-flat/24/user-256.png",class:"img-thumbnail",id:"fotoimg",alt:""},ce={class:"input-group mb-3"},me=M(()=>d("span",{class:"input-group-text"},[d("i",{class:"fa-solid fa-gift"})],-1));function pe(l,e,n,g,o,a){return r(),m(T,{class:"bg-grey-2"},{default:i(()=>[t(v,{flat:"",bordered:""},{default:i(()=>[t(p,null,{default:i(()=>[t(E,{flat:"",bordered:"",dense:"",rows:o.sueldos,"row-key":"id",columns:l.columns,class:"styled-table","hide-bottom":""},{"top-right":i(()=>[t(c,{icon:"add",label:"Nuevo Sueldo",color:"primary",onClick:a.openDialog},null,8,["onClick"])]),"body-cell-acciones":i(s=>[t(q,{flat:"",dense:"",color:"primary","no-caps":"",label:"Opciones"},{default:i(()=>[_((r(),m(y,{clickable:"",onClick:x=>a.editSueldo(s.row)},{default:i(()=>[t(F,null,{default:i(()=>[t(h,{name:"edit"}),f(" Editar ")]),_:1})]),_:2},1032,["onClick"])),[[S],[b]]),_((r(),m(y,{clickable:"",onClick:x=>a.deleteSueldo(s.row)},{default:i(()=>[t(F,null,{default:i(()=>[t(h,{name:"delete"}),f(" Eliminar ")]),_:1})]),_:2},1032,["onClick"])),[[S],[b]])]),_:2},1024)]),_:1},8,["rows","columns"])]),_:1})]),_:1}),t(Q,{modelValue:o.dialog,"onUpdate:modelValue":e[21]||(e[21]=s=>o.dialog=s),"transition-show":"slide-up","transition-hide":"slide-down"},{default:i(()=>[t(v,{style:{width:"500px","max-width":"100vw"}},{default:i(()=>[t(p,{class:"row items-center bg-primary text-white"},{default:i(()=>[_(t(c,{flat:"",round:"",dense:"",icon:"arrow_back"},null,512),[[b]]),t(I),d("div",N,U(o.sueldo.id?"Editar Sueldo":"Nuevo Sueldo"),1)]),_:1}),t(p,null,{default:i(()=>[t(P,{onSubmit:j(a.saveSueldo,["prevent"])},{default:i(()=>[d("div",L,[t(u,{dense:"",modelValue:o.sueldo.sueldo_correspondiente,"onUpdate:modelValue":e[0]||(e[0]=s=>o.sueldo.sueldo_correspondiente=s),type:"date",outlined:"",label:"sueldo Correspondiente"},null,8,["modelValue"])]),d("div",O,[d("div",R,[t(D,{dense:"",modelValue:o.sueldo.tipo,"onUpdate:modelValue":e[1]||(e[1]=s=>o.sueldo.tipo=s),options:["PERMANENTE","TEMPORAL"],outlined:"",label:"Tipo"},null,8,["modelValue"])]),d("div",z,[t(D,{modelValue:o.sueldo.ejecutivo_id,"onUpdate:modelValue":[e[2]||(e[2]=s=>o.sueldo.ejecutivo_id=s),a.changeDirecionTelefono],onFilter:a.filterEjecutivos,rules:[s=>!!s||"Seleccione un cliente"],filled:"","emit-value":"","map-options":"",standout:"","use-input":"",label:"Nombre",options:o.ejecutivos,"option-value":"id","option-label":"nombre_eje",dense:"",clearable:""},null,8,["modelValue","onFilter","onUpdate:modelValue","rules","options"])]),d("div",G,[t(u,{dense:"",modelValue:o.sueldo.ci,"onUpdate:modelValue":e[3]||(e[3]=s=>o.sueldo.ci=s),outlined:"",label:"C.I."},null,8,["modelValue"])]),d("div",H,[t(u,{dense:"",modelValue:o.sueldo.cargo,"onUpdate:modelValue":e[4]||(e[4]=s=>o.sueldo.cargo=s),outlined:"",label:"Cargo"},null,8,["modelValue"])]),d("div",J,[t(u,{dense:"",modelValue:o.sueldo.fecha_ingreso,"onUpdate:modelValue":e[5]||(e[5]=s=>o.sueldo.fecha_ingreso=s),type:"date",outlined:"",label:"Fecha de Ingreso"},null,8,["modelValue"])]),d("div",W,[t(u,{dense:"",modelValue:o.sueldo.haber_basico,"onUpdate:modelValue":e[6]||(e[6]=s=>o.sueldo.haber_basico=s),outlined:"",type:"number",label:"Haber B\xE1sico"},null,8,["modelValue"])]),d("div",X,[t(u,{dense:"",modelValue:o.sueldo.bono_antiguedad,"onUpdate:modelValue":e[7]||(e[7]=s=>o.sueldo.bono_antiguedad=s),outlined:"",type:"number",label:"bono antiguedad"},null,8,["modelValue"])]),d("div",Z,[t(u,{dense:"",modelValue:o.sueldo.monto_acumulado,"onUpdate:modelValue":e[8]||(e[8]=s=>o.sueldo.monto_acumulado=s),outlined:"",type:"number",label:"total Ganado",readonly:""},null,8,["modelValue"])]),d("div",K,[t(u,{dense:"",modelValue:o.sueldo.descuento_afp,"onUpdate:modelValue":e[9]||(e[9]=s=>o.sueldo.descuento_afp=s),outlined:"",type:"number",label:"Descuento AFP (0.5%)",readonly:""},null,8,["modelValue"])]),d("div",$,[t(u,{dense:"",modelValue:o.sueldo.descuento_seguro,"onUpdate:modelValue":e[10]||(e[10]=s=>o.sueldo.descuento_seguro=s),outlined:"",type:"number",label:"Descuento Seguro"},null,8,["modelValue"])]),d("div",ee,[t(u,{dense:"",modelValue:o.sueldo.descuento_solidario,"onUpdate:modelValue":e[11]||(e[11]=s=>o.sueldo.descuento_solidario=s),outlined:"",type:"number",label:"Descuento Solidario"},null,8,["modelValue"])]),d("div",oe,[t(u,{dense:"",modelValue:o.sueldo.descuento_otros,"onUpdate:modelValue":e[12]||(e[12]=s=>o.sueldo.descuento_otros=s),outlined:"",type:"number",label:"Descuento Otros"},null,8,["modelValue"])]),d("div",le,[t(u,{dense:"",modelValue:o.sueldo.total_descuentos_lab,"onUpdate:modelValue":e[13]||(e[13]=s=>o.sueldo.total_descuentos_lab=s),outlined:"",type:"number",label:"Total Descuento"},null,8,["modelValue"])]),d("div",se,[t(u,{dense:"",modelValue:o.sueldo.total_liquido,"onUpdate:modelValue":e[14]||(e[14]=s=>o.sueldo.total_liquido=s),outlined:"",type:"number",label:"total liquido",readonly:""},null,8,["modelValue"])]),d("div",te,[t(u,{dense:"",modelValue:o.sueldo.descuento_rc_iva,"onUpdate:modelValue":e[15]||(e[15]=s=>o.sueldo.descuento_rc_iva=s),outlined:"",type:"number",label:"Descuento rc_iva"},null,8,["modelValue"])]),d("div",de,[t(u,{dense:"",modelValue:o.sueldo.descuento_anticipo,"onUpdate:modelValue":e[16]||(e[16]=s=>o.sueldo.descuento_anticipo=s),outlined:"",type:"number",label:"Descuento anticipo	"},null,8,["modelValue"])]),d("div",ue,[t(u,{dense:"",modelValue:o.sueldo.total_descuentos,"onUpdate:modelValue":e[17]||(e[17]=s=>o.sueldo.total_descuentos=s),outlined:"",type:"number",label:"Total Descuento	"},null,8,["modelValue"])]),d("div",ie,[t(u,{dense:"",modelValue:o.sueldo.liquido_pagable,"onUpdate:modelValue":e[18]||(e[18]=s=>o.sueldo.liquido_pagable=s),outlined:"",type:"number",label:"L\xEDquido Pagable"},null,8,["modelValue"])]),d("div",ne,[o.sueldo.foto?(r(),V("img",{key:0,src:o.sueldo.foto.includes("data")?o.sueldo.foto:l.$url+".."+o.sueldo.foto,alt:"Imagen del sueldo",class:"img-thumbnail",height:"100"},null,8,ae)):(r(),V("img",re))]),d("div",ce,[me,d("input",{onChange:e[19]||(e[19]=(...s)=>l.previsualizarFoto&&l.previsualizarFoto(...s)),type:"file",accept:"image/png, image/jpg, image/gif",class:"form-control"},null,32)])]),t(C,{align:"right"},{default:i(()=>[t(c,{label:"Cancelar",flat:"",color:"negative",onClick:e[20]||(e[20]=s=>o.dialog=!1),loading:o.loading},null,8,["loading"]),t(c,{label:"Guardar",flat:"",color:"primary",type:"submit",loading:o.loading},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var xe=Y(B,[["render",pe],["__scopeId","data-v-61e73e2b"]]);export{xe as default};
